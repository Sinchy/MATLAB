N = 20;
sys_x = armax(wrong_track2D(10:N,1),[1 2])
sys_y = armax(wrong_track2D(10:N,2),[1 2])
sys_z = armax(wrong_track2D(10:N,3),[1 2])
x_p0 = forecast(sys_x, wrong_track2D(10:N,1),1)
y_p0 = forecast(sys_y, wrong_track2D(10:N,2),1)
z_p0 = forecast(sys_z, wrong_track2D(10:N,3),1)
plot3(x_p0, y_p0, z_p0, 'go')
x = predict(sys_x, wrong_track2D(10:N,1), 1)
y = predict(sys_y,wrong_track2D(10:N,2),1)
z = predict(sys_z,wrong_track2D(10:N,3),1)
plot3(x,y,z,'r*')
p_x = polyfit(1:(N - 10 + 1), x', 3)
p_y = polyfit(1:(N - 10 + 1), y', 3)
p_z = polyfit(1:(N - 10 + 1), z', 3)
x_p = polyval(p_x, N - 10 + 2)
y_p = polyval(p_y, N - 10 + 2)
z_p = polyval(p_z, N - 10 + 2)
plot3(x_p, y_p, z_p, 'ro')
